<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>手机相册</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="../styles/img_browser.css">
    <link rel="stylesheet" href="../styles/sidebar.css">

</head>

<body>
    <div id="sidebar">
        <div class="user_info">
            <h2>用户名:</h2>
        </div>
        <ul>
            <li>
                <a href="./transfer.html"><i class="fas fa-file-upload"></i>文件传输</a>
            </li>
            <li>
                <a href="./img_browser.html"><i class="fas fa-images"></i>查看手机照片</a>
            </li>
            <li>
                <a href="./settings.html"><i class="fas fa-cogs"></i>设置</a>
            </li>
        </ul>
        <div class="signal-container"> <!-- 用于容纳信号图标 -->
            <div class="signal-icon"><i class="fas fa-signal"></i></div> <!-- 信号图标小方块 -->
        </div>
    </div>
    <div id="content">
        <div class="photo_gallery" id="photoGallery">
            <img>
            <button class="left_button" onclick="prevPage()" id="prev-btn">&lt;</button>
            <button class="right_button" onclick="nextPage()" id="next-btn">&gt;</button>
            <el-button></el-button>
            <div class="photo_id" id="photo_id">1</div>
        </div>

    </div>

    <script>
        // 模拟接收后端信息并改变信号图标颜色的示例代码
        setTimeout(function () {
            document.querySelector('.signal-icon').classList.add('connected'); // 当接收到后端信息后，添加 connected 类来改变颜色为绿色
        }, 1000); // 3秒后模拟接收到后端信息

        var maxValue = 100; // 初始化最大值为100
        var minValue = 1

        // 发送 AJAX 请求以获取最大值
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {
                    var response = JSON.parse(xhr.responseText);
                    maxValue = response.maxValue;

                    // 在获得最大值后更新页面上的最大值元素
                    var maxInput = document.getElementById('maxValue');
                    maxInput.value = maxValue.toString();
                } else {
                    console.error('Failed to get max value.');
                }
            }
        };
        xhr.open('GET', '/img_browser'); // 向根路径发送 GET 请求
        xhr.send();

        function nextPage() {
            var number = document.getElementById('photo_id');
            var currentValue = parseInt(number.textContent);
            if (currentValue < maxValue) {
                number.textContent = currentValue + 1;
            } else {
                number.textContent = minValue.toString();
            }
        }

        function prevPage() {
            var number = document.getElementById('photo_id');
            var currentValue = parseInt(number.textContent);
            if (currentValue > minValue) {
                number.textContent = currentValue - 1;
            } else {
                number.textContent = maxValue.toString();
            }
        }
    </script>
    <script src="./main.js">
    </script>
</body>

</html>